<!doctype html>
<html>
    <head>
        <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=no, maximum-scale=1.0, minimum-scale=1.0">
        <title>Quink Example - toolbar menu</title>
        <script type="text/javascript">
            var Menu = function (isMultiSelect) {
                this.isMultiSelect = isMultiSelect;
                this.state = [];
            }

            Menu.prototype.create = function () {
                return [{
                    label: 'option1',
                    value: '1'
                }, {
                    label: 'option 2',
                    value: '2'
                }, {
                    label: 'option 3',
                    value: '3'
                }];
            }
            Menu.prototype.getState = function () {
                return this.state;
            }
            Menu.prototype.onSelect = function (newValue, oldValue) {
                if (newValue !== 'close') {
                    if (this.isMultiSelect) {
                        index = this.state.indexOf(newValue);
                        if (index >= 0) {
                            this.state.splice(index, 1);
                        } else {
                            this.state.push(newValue);
                        }
                    } else {
                        if (newValue !== oldValue) {
                            this.state[0] = newValue;
                        } else {
                            this.state.length = 0;
                        }
                    }
                }
            };

            QUINK = {
                params: {
                    toolbar: 'on'
                },
                ready: function () {
                    QUINK.configureToolbar({
                        groups: [{
                            id: 'buttons',
                            label: 'Buttons',
                            active: true,
                            hidden: false,
                            items: [{
                                "id": "singlemenu",
                                "hidden": false,
                                "elId": "singlemenu",
                                "cssClass": "qk_button_bg_applystyle",
                                "command": "showMenu",
                                "commandArgs": "createSingleDefs, getSingleState, onSingleSelect"
                            }, {
                                "id": "multimenu",
                                "hidden": false,
                                "elId": "multimenu",
                                "cssClass": "qk_button_bg_applystyle",
                                "command": "showMenu",
                                "commandArgs": "createMultiDefs, getMultiState, onMultiSelect, true"
                            }]
                        }],
                        defaults: {
                            hidden: true
                        }
                    });

                    QUINK.createSingleDefs = function () {
                        this.singleMenu = new Menu();
                        return this.singleMenu.create();
                    };

                    QUINK.getSingleState = function () {
                        return this.singleMenu.getState();
                    };

                    QUINK.onSingleSelect = function (newValue, oldValue) {
                        this.singleMenu.onSelect(newValue, oldValue);
                    };

                    QUINK.createMultiDefs = function () {
                        this.multiMenu = new Menu(true);
                        return this.multiMenu.create();
                    };

                    QUINK.getMultiState = function () {
                        return this.multiMenu.getState();
                    };

                    QUINK.onMultiSelect = function (newValue, oldValue) {
                        this.multiMenu.onSelect(newValue, oldValue);
                    };
                }
            }
        </script>
        <script type="text/javascript" src="../../quink.js"></script>
    </head>
    <body>
        <div contenteditable="true">
            The is example shows a toolbar menu configured via client code. Tap the button and a menu will be displayed. The menu does nothing other than maintain its own state.
        </div>
    </body>
</html>
